# ✅ Step 1 – Install and Import
!pip install -q ultralytics

from ultralytics import YOLO
import matplotlib.pyplot as plt
import cv2

# ✅ Step 2 – Load a pretrained YOLOv8 model
# You can use yolov8n.pt (nano), yolov8s.pt (small), yolov8m.pt (medium), etc.
model = YOLO('yolov8n.pt')  # downloads automatically# ✅ Step 3 – Download a sample image to test
import urllib.request

url = "https://ultralytics.com/images/zidane.jpg"
urllib.request.urlretrieve(url, "sample.jpg")# ✅ Step 4 – Run object detection
results = model.predict(source="sample.jpg", conf=0.25, save=True)

# results[0] holds detection info (boxes, labels, confidence, etc.)
print("Detected Objects:", results[0].boxes.cls.tolist())
print("Confidence Scores:", results[0].boxes.conf.tolist())

# ✅ Step 5 – Display the output image
# YOLO saves results automatically under 'runs/detect/predict' folder
output_path = results[0].save_dir / results[0].path.name

# Read and show image with boxes
img = cv2.imread(str(output_path))
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
plt.figure(figsize=(8,6))
plt.imshow(img)
plt.axis('off')
plt.title("YOLOv8 Object Detection Result")
plt.show()
